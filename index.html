<!DOCTYPE html>
<html>
  <head>
    <title>File Upload to Google Drive</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      h1 {
        text-align: center;
      }

      .file-upload-container {
        margin-top: 20px;
      }

      .file-upload-container input[type="file"] {
        display: none;
      }

      .file-upload-container label {
        padding: 10px 20px;
        background-color: #4caf50;
        color: #fff;
        cursor: pointer;
      }

      .file-upload-container button {
        margin-top: 10px;
        padding: 10px 20px;
        background-color: #4caf50;
        color: #fff;
        border: none;
        cursor: pointer;
      }
    </style>
    <script src="https://apis.google.com/js/api.js"></script>
  </head>
  <body>
    <h1>File Upload to Google Drive</h1>
    <div class="file-upload-container">
      <input type="file" id="fileInput">
      <label for="fileInput">Choose File</label>
      <button onclick="uploadFile()">Upload</button>
    </div>
    <script>
      const CLIENT_ID = '924258763370-v088pqs6rgrbrtj41cqbham54a162hl4.apps.googleusercontent.com';
      const SCOPES = 'https://www.googleapis.com/auth/drive.file';
      const REDIRECT_URI = 'https://itaycoifman.github.io/oauth2callback';

      function handleAuthResult(authResult) {
        if (authResult && !authResult.error) {
          loadDriveAPI();
        } else {
          console.error('Authorization error:', authResult.error);
        }
      }

      function handleAuthClick() {
        gapi.auth.authorize(
          {
            client_id: CLIENT_ID,
            scope: SCOPES,
            immediate: false,
            redirect_uri: REDIRECT_URI
          },
          handleAuthResult
        );
      }

      function loadDriveAPI() {
        gapi.client.load('drive', 'v3', () => {
          console.log('Google Drive API loaded.');
        });
      }

      function uploadFile() {
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];
        if (!file) {
          console.error('No file selected.');
          return;
        }

        const metadata = {
          name: file.name,
          mimeType: file.type,
          parents: ['https://drive.google.com/drive/folders/1RuWaX7smjSdF7EhM0VGtGsaDJndR4WA6?usp=share_link'] // Replace with the desired parent directory ID
        };

        const request = gapi.client.request({
          path: '/upload/drive/v3/files',
          method: 'POST',
          params: { uploadType: 'media' },
          headers: {
            'Content-Type': file.type,
          },
          body: file
        });

        request.execute((response) => {
          console.log('File uploaded successfully:', response);
        });
      }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleAuthClick"></script>
  </body>
</html>
